<?xml version="1.0"?>
<project name="dataprep" basedir="." default="printData">
    <!-- HSQLDB -->
    <property name="db.driver" value="org.hsqldb.jdbcDriver"/>
    <property name="db.url" value="jdbc:hsqldb:file:mydb"/>
    <property name="db.user" value="sa"/>
    <property name="db.pw" value=""/>
	
    <path id="master-classpath">
        <fileset dir="lib/">
            <include name="*.jar"/>
        </fileset>
    </path>
	
    <target name="createTables">
        <echo message="CREATE TABLES USING: ${db.driver} ${db.url}"/>
        <sql driver="${db.driver}"
                     url="${db.url}"
                     userid="${db.user}"
                     password="${db.pw}"
                     onerror="stop">
            <classpath refid="master-classpath"/>
            CREATE TABLE products (
            id INTEGER IDENTITY,
            description varchar(255),
            price decimal(15,2)
            );
            CREATE INDEX products_description ON products(description);
        	create table accounts(id INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 100) PRIMARY KEY, name varchar(50), balance decimal(15,2));
            COMMIT;
            SHUTDOWN;
        </sql>
        <!-- For MySQL use, id INTEGER NOT NULL PRIMARY KEY auto_increment, -->
        <!-- For HSQL use,  id INTEGER IDENTITY, -->
    </target>
    <target name="dropTables">
        <echo message="DROP TABLES USING: ${db.driver} ${db.url}"/>
        <sql driver="${db.driver}"
                     url="${db.url}"
                     userid="${db.user}"
                     password="${db.pw}"
                     onerror="continue">
            <classpath refid="master-classpath"/>
            DROP TABLE products;
            drop table accounts;
            COMMIT;        
            SHUTDOWN			
        </sql>
    </target>

    <target name="clearData">
        <echo message="REMOVING DATA USING: ${db.driver} ${db.url}"/>
        <sql driver="${db.driver}"
                     url="${db.url}"
                     userid="${db.user}"
                     password="${db.pw}"
                     onerror="continue">
            <classpath refid="master-classpath"/>
            DELETE FROM products;
            delete from accounts;
            COMMIT;
            SHUTDOWN
        </sql>
    </target>

    <target name="loadData" depends="clearData">
        <echo message="LOAD TABLES USING: ${db.driver} ${db.url}"/>
        <sql driver="${db.driver}"
                     url="${db.url}"
                     userid="${db.user}"
                     password="${db.pw}"
                     onerror="continue">
            <classpath refid="master-classpath"/>
            INSERT INTO products (description, price) values('Lamp', 5.78);
            INSERT INTO products (description, price) values('Table', 75.29);
            INSERT INTO products (description, price) values('Chair', 22.81);        
            INSERT INTO accounts (id, name, balance) values(100, "George", 100);        
            INSERT INTO accounts (id, name, balance) values(101, "Ringo", 100);        
            INSERT INTO accounts (id, name, balance) values(102, "John", 100);        
            INSERT INTO accounts (id, name, balance) values(103, "Paul", 100);        
            COMMIT;        
            SHUTDOWN			
        </sql>
    </target>
	
    <target name="printData">
        <echo message="PRINT TABLES USING: ${db.driver} ${db.url}"/>
        <sql driver="${db.driver}"
                     url="${db.url}"
                     userid="${db.user}"
                     password="${db.pw}"
                     onerror="continue"
                     print="true">
            <classpath refid="master-classpath"/>
			
            SELECT * FROM products;
            select * from accounts;
            SHUTDOWN
        </sql>
    </target>
	
</project>